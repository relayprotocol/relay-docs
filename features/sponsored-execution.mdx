---
title: "Sponsored Execution"
description: "Submit arbitrary transactions for execution while sponsoring fees"
---

## How does it work?

Gasless transactions on EVM are regular transactions where the transaction signer and the gas payer are two different addresses. Rather than signing with the same address and then submitting their transaction and paying gas, a user can simply sign a transaction payload, and other entities (relayers, solvers, etc.) can submit the transaction on their behalf and sponsor the gas costs.

This is not natively possible, so there are custom transaction payloads to enable this: [Permit2](https://github.com/dragonfly-xyz/useful-solidity-patterns/tree/main/patterns/permit2), [EIP-3009](https://eips.ethereum.org/EIPS/eip-3009), [EIP-2771 payloads](https://eips.ethereum.org/EIPS/eip-2771), [EIP-4337 user operations](https://eips.ethereum.org/EIPS/eip-4337), etc. The core concept is that as long as the transaction does not depend on `msg.sender` (the transaction submittor), any actor can execute call data on behalf of any address.

This is where the `/execute` API comes in. The API allows users to submit raw calls (the partial payload of a regular EVM transaction). It includes the `to`, `data`, `value` and an optional EIP-7702 `authorizationList`.

## How to use it?

This feature is only currently available to Enterprise Partners, learn more about the [Enterprise Partner Program](/resources/enterprise) to get started. Once you're an Enterprise Partner you should have an API key and a linked funding address. You'll then need to fund your app balance, you can learn more about that [here](/features/fee-sponsorship).

### Executing a gasless quote

In this example use case you want to execute a gasless Relay quote with the [execute](/references/api/execute) API.

<Steps>
  <Step title="Detect Smart Wallet">
    Determine if the transaction signer is not a smart wallet. This use case expects `msg.sender` to be the transaction signer, to work around this we need to ensure the transaction signer is a smart wallet and if not we'll need to upgrade temporarily using EPI-7702 to point to a smart contract.
    ```typescript
      const walletClient = ... // replace with your wallet client or equivalent
      const chainId = await walletClient.getChainId()
      const address = primaryWallet.address as `0x${string}`
      const isSmartWallet = async (address: `0x${string}`, chainId: number) => {
        const viemClient = createPublicClient({
          chain: getClient().chains.find((chain) => chain.id === chainId)
            ?.viemChain,
          transport: http()
        })
        const code = await viemClient.getCode({
          address
        })
        return code && code != '0x'
      }
      const isSmartWalletResult = await isSmartWallet(address, chainId)
    ```
    _Note: You can skip this step if your use case doesn't rely on `msg.sender` being the transaction signer._
  </Step>
  <Step title="Optional: Authorize with 7702">
    If we detect that the transaction signer is not a smart wallet, we'll need to upgrade it to a smart wallet using EIP-7702. Notet that you'll need access to the private key or a local account in order to sign the authorization.
    ```typescript
      const authorizationList = await walletClient.signAuthorization({
        account: wallet.account,
        contractAddress: YOUR_SMART_ACCOUNT_CONTRACT_ADDRESS, //Replace with your smart contract proxy address
      })
    ```
    For a full guide on how to do this, see the [signAuthorization guide](https://viem.sh/docs/eip7702/signAuthorization#signauthorization).
  </Step>
  <Step title="Get a quote">
    Use the [quote endpoint](/references/api/get-quote-v2) to get a quote for the transaction you want to execute.
    <CodeGroup>
     ```bash cURL
      curl -X POST "https://api.relay.link/quote/v2" \
      -H "Content-Type: application/json" \
      -d '{
        "user": "YOUR_WALLET_ADDRESS",
        "originChainId": 8453,
        "destinationChainId": 42161,
        "originCurrency": "0x0000000000000000000000000000000000000000",
        "destinationCurrency": "0x0000000000000000000000000000000000000000",
        "amount": "100000000000000",
        "tradeType": "EXACT_INPUT"
      }'
      ```
      ```json Response expandable
      {
        "steps": [
          {
            "id": "deposit",
            "action": "Confirm transaction in your wallet",
            "description": "Depositing funds to the relayer to execute the swap for ETH",
            "kind": "transaction",
            "items": [
              {
                "status": "incomplete",
                "data": {
                  "from": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
                  "to": "0x4cd00e387622c35bddb9b4c962c136462338bc31",
                  "data": "0x49290c1c00000000000000000000000003508bb71268bba25ecacc8f620e01866650532c70387ea00ba97925c3bf1263363b2a7bdc0401faa00f0af4140627c7f385952c",
                  "value": "100000000000000",
                  "chainId": 8453,
                  "maxFeePerGas": "3501361",
                  "maxPriorityFeePerGas": "1000007"
                },
                "check": {
                  "endpoint": "/intents/status/v3?requestId=0xa9ad21ed31b40317d2dad7750d642b8a72adf086f250f8a33c1636488c780878",
                  "method": "GET"
                }
              }
            ],
            "requestId": "0xa9ad21ed31b40317d2dad7750d642b8a72adf086f250f8a33c1636488c780878",
            "depositAddress": ""
          }
          # ...
        ],
        "fees": {
          "gas": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "89121108862",
            "amountFormatted": "0.000000089121108862",
            "amountUsd": "0.000279",
            "minimumAmount": "89121108862"
          },
          "relayer": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "9212128356056",
            "amountFormatted": "0.000009212128356056",
            "amountUsd": "0.028858",
            "minimumAmount": "9212128356056"
          },
          "relayerGas": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "1219936568400",
            "amountFormatted": "0.0000012199365684",
            "amountUsd": "0.003822",
            "minimumAmount": "1219936568400"
          },
          "relayerService": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "7992191787656",
            "amountFormatted": "0.000007992191787656",
            "amountUsd": "0.025037",
            "minimumAmount": "7992191787656"
          },
          "app": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "0",
            "amountFormatted": "0.0",
            "amountUsd": "0",
            "minimumAmount": "0"
          },
          "subsidized": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "0",
            "amountFormatted": "0.0",
            "amountUsd": "0",
            "minimumAmount": "0"
          }
        },
        "details": {
          "operation": "swap",
          "sender": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
          "recipient": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
          "currencyIn": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "100000000000000",
            "amountFormatted": "0.0001",
            "amountUsd": "0.313265",
            "minimumAmount": "100000000000000"
          },
          "currencyOut": {
            "currency": {
              "chainId": 42161,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "90787871643944",
            "amountFormatted": "0.000090787871643944",
            "amountUsd": "0.284407",
            "minimumAmount": "86520841676679"
          },
          "refundCurrency": {
            "currency": {
              "chainId": 8453,
              "address": "0x0000000000000000000000000000000000000000",
              "symbol": "ETH",
              "name": "Ether",
              "decimals": 18,
              "metadata": {
                "logoURI": "https://assets.relay.link/icons/1/light.png",
                "verified": true
              }
            },
            "amount": "100000000000000",
            "amountFormatted": "0.0001",
            "amountUsd": "0.313265",
            "minimumAmount": "100000000000000"
          },
          "totalImpact": {
            "usd": "-0.028858",
            "percent": "-9.21"
          },
          "swapImpact": {
            "usd": "0.000000",
            "percent": "0.00"
          },
          "expandedPriceImpact": {
            "swap": {
              "usd": "-0.000030"
            },
            "execution": {
              "usd": "-0.023822"
            },
            "relay": {
              "usd": "-0.005007"
            },
            "app": {
              "usd": "0"
            }
          },
          "rate": "0.90787871643944",
          "slippageTolerance": {
            "origin": {
              "usd": "0.000000",
              "value": "0",
              "percent": "0.00"
            },
            "destination": {
              "usd": "0.013339",
              "value": "4267029967265",
              "percent": "4.69"
            }
          },
          "timeEstimate": 1,
          "userBalance": "0",
          "isFixedRate": true,
          "route": {
            "origin": {
              "inputCurrency": {
                "currency": {
                  "chainId": 8453,
                  "address": "0x0000000000000000000000000000000000000000",
                  "symbol": "ETH",
                  "name": "Ether",
                  "decimals": 18,
                  "metadata": {
                    "logoURI": "https://assets.relay.link/icons/1/light.png",
                    "verified": true
                  }
                },
                "amount": "100000000000000",
                "amountFormatted": "0.0001",
                "amountUsd": "0.313265",
                "minimumAmount": "100000000000000"
              },
              "outputCurrency": {
                "currency": {
                  "chainId": 8453,
                  "address": "0x0000000000000000000000000000000000000000",
                  "symbol": "ETH",
                  "name": "Ether",
                  "decimals": 18,
                  "metadata": {
                    "logoURI": "https://assets.relay.link/icons/1/light.png",
                    "verified": true
                  }
                },
                "amount": "100000000000000",
                "amountFormatted": "0.0001",
                "amountUsd": "0.313265",
                "minimumAmount": "100000000000000"
              },
              "router": "relay"
            },
            "destination": {
              "inputCurrency": {
                "currency": {
                  "chainId": 42161,
                  "address": "0x0000000000000000000000000000000000000000",
                  "symbol": "ETH",
                  "name": "Ether",
                  "decimals": 18,
                  "metadata": {
                    "logoURI": "https://assets.relay.link/icons/1/light.png",
                    "verified": true
                  }
                },
                "amount": "90787871643944",
                "amountFormatted": "0.000090787871643944",
                "amountUsd": "0.284407",
                "minimumAmount": "86520841676679"
              },
              "outputCurrency": {
                "currency": {
                  "chainId": 42161,
                  "address": "0x0000000000000000000000000000000000000000",
                  "symbol": "ETH",
                  "name": "Ether",
                  "decimals": 18,
                  "metadata": {
                    "logoURI": "https://assets.relay.link/icons/1/light.png",
                    "verified": true
                  }
                },
                "amount": "90787871643944",
                "amountFormatted": "0.000090787871643944",
                "amountUsd": "0.284407",
                "minimumAmount": "86520841676679"
              },
              "router": "relay"
            }
          }
        },
        "protocol": {
          "v2": {
            "orderId": "0x70387ea00ba97925c3bf1263363b2a7bdc0401faa00f0af4140627c7f385952c",
            "orderData": {
              "version": "v1",
              "solverChainId": "base",
              "solver": "0xf70da97812cb96acdf810712aa562db8dfa3dbef",
              "salt": "0x7cae8841bbd4c7c9da1b2a8d9ebdc948d54f5cb4178aca2d289e65edc1bddf52",
              "inputs": [
                {
                  "payment": {
                    "chainId": "base",
                    "currency": "0x0000000000000000000000000000000000000000",
                    "amount": "100000000000000",
                    "weight": "1"
                  },
                  "refunds": [
                    {
                      "chainId": "base",
                      "recipient": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
                      "currency": "0x0000000000000000000000000000000000000000",
                      "minimumAmount": "0",
                      "deadline": 1768418493,
                      "extraData": "0x000000000000000000000000b92fe925dc43a0ecde6c8b1a2709c170ec4fff4f"
                    },
                    {
                      "chainId": "arbitrum",
                      "recipient": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
                      "currency": "0x0000000000000000000000000000000000000000",
                      "minimumAmount": "0",
                      "deadline": 1768418493,
                      "extraData": "0x000000000000000000000000b92fe925dc43a0ecde6c8b1a2709c170ec4fff4f"
                    }
                  ]
                }
              ],
              "output": {
                "chainId": "arbitrum",
                "payments": [
                  {
                    "recipient": "0x03508bB71268BBA25ECaCC8F620e01866650532c",
                    "currency": "0x0000000000000000000000000000000000000000",
                    "minimumAmount": "86520841676679",
                    "expectedAmount": "90787871643944"
                  }
                ],
                "calls": [],
                "deadline": 1768418493,
                "extraData": "0x000000000000000000000000b92fe925dc43a0ecde6c8b1a2709c170ec4fff4f"
              },
              "fees": []
            },
            "paymentDetails": {
              "chainId": "base",
              "depository": "0x4cd00e387622c35bddb9b4c962c136462338bc31",
              "currency": "0x0000000000000000000000000000000000000000",
              "amount": "100000000000000"
            }
          }
        }
      }
      ```
    </CodeGroup>
  </Step>
  <Step title="Execute the transaction">
    With the quote in hand, you can now execute the transaction. You'll need to pass the data from previous steps to the api.
    ```typescript
      const options = {
        method: 'POST',
        headers: {'x-api-key': 'YOUR_API_KEY', 'Content-Type': 'application/json'},
        body: JSON.stringify({
          requestId: steps[0].requestId, //Quote requestId from previous step
          executionKind: 'rawCalls',
          data: {
            chainId: 8453,
            to: 'YOUR_WALLET_ADDRESS',
            data: steps[0].items[0].data.data, //Quote data from previous step
            value: 0,
            //Only relevant if using EIP-7702
            authorizationList: [
              {
                chainId: authorization.chainId,
                address: authorization.address, //This is your smart contract proxy address
                nonce: authorization.nonce,
                yParity: authorization.yParity,
                r: authorization.r,
                s: authorization.s
              }
            ]
          },
          executionOptions: {
            subsidizeFees: true, //Set this to pay for destination fees
          }
        })
      };

      fetch('https://api.relay.link/execute', options)
        .then(res => res.json())
        .then(res => console.log(res))
        .catch(err => console.error(err));
    ```
  </Step>
  <Step title="Monitor">
    Now that the transaction has been submitted, you can monitor the status of the transaction using the requestId from the quote data and the status endpoint[/references/api/get-intents-status-v3].
    ```typescript
      const response = await fetch(`https://api.relay.link/intents/status/v3?requestId=${requestId}`);
      const data = await response.json();
      console.log(data);
    ```
  </Step>
    Refer to the [quickstart guide](/references/api/quickstart#status-lifecycle) for more information on how to monitor the status of a transaction.
</Steps>

## Caveats

* Only EVM chains are supported currently.
* Partial sponsorship is not yet supported. Should the fees amount to more than the app balance, the transaction will not be sponsored.
* If the transaction relies on `msg.sender`, the transaction signer must be a smart wallet (EIP-7702, EIP-4337, etc).